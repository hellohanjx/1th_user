; generated by Component: ARM Compiler 5.06 update 6 (build 750) Tool: ArmCC [4d3637]
; commandline ArmCC [--list --debug -c --asm --interleave -o.\output\os_q.o --asm_dir=.\Listing\ --list_dir=.\Listing\ --depend=.\output\os_q.d --cpu=Cortex-M3 --apcs=interwork -O0 --diag_suppress=9931 -I..\Libraries\STM32F10x_StdPeriph_Driver\inc -I..\Libraries\CMSIS\CM3\DeviceSupport\ST\STM32F10x -I..\bsp_lib -I..\UCOSII\port -I..\UCOSII\src -I..\UCOSII\uC-CPU -I..\Libraries\CMSIS -I..\User\INCLUDES -I..\LCD -I..\USR\Global -I..\USR -I..\USR\FSM -I..\USR\Commucation -I..\USR\Mdb -I..\USR\Drop -I..\USR\DriverBoard -I..\USR\Flash -I..\USR\Card -I..\USR\MSG -I..\USR\Bsp -I..\USR\SetPar -I..\User\QRCode -I..\USR\MEM -I..\USR\QRCode -I..\USR\SETUP -I..\USR\stm32 -IC:\Keil_v5\ARM\RV31\INC -IC:\Keil_v5\ARM\CMSIS\Include -IC:\Keil_v5\ARM\INC\ST\STM32F10x -D__MICROLIB -D__UVISION_VERSION=525 -DSTM32F10X_HD -DUSE_STDPERIPH_DRIVER --omf_browse=.\output\os_q.crf ..\UCOSII\src\os_q.c]
                          THUMB

                          AREA ||.text||, CODE, READONLY, ALIGN=2

                  OSQAccept PROC
;;;60     #if OS_Q_ACCEPT_EN > 0
;;;61     void  *OSQAccept (OS_EVENT *pevent, INT8U *perr)
000000  e92d41f0          PUSH     {r4-r8,lr}
;;;62     {
000004  4606              MOV      r6,r0
000006  460d              MOV      r5,r1
;;;63         void      *pmsg;
;;;64         OS_Q      *pq;
;;;65     #if OS_CRITICAL_METHOD == 3                      /* Allocate storage for CPU status register           */
;;;66         OS_CPU_SR  cpu_sr = 0;
000008  f04f0800          MOV      r8,#0
;;;67     #endif
;;;68     
;;;69     
;;;70     
;;;71     #if OS_ARG_CHK_EN > 0
;;;72         if (perr == (INT8U *)0) {                    /* Validate 'perr'                                    */
00000c  b915              CBNZ     r5,|L1.20|
;;;73             return ((void *)0);
00000e  2000              MOVS     r0,#0
                  |L1.16|
;;;74         }
;;;75         if (pevent == (OS_EVENT *)0) {               /* Validate 'pevent'                                  */
;;;76             *perr = OS_ERR_PEVENT_NULL;
;;;77             return ((void *)0);
;;;78         }
;;;79     #endif
;;;80         if (pevent->OSEventType != OS_EVENT_TYPE_Q) {/* Validate event block type                          */
;;;81             *perr = OS_ERR_EVENT_TYPE;
;;;82             return ((void *)0);
;;;83         }
;;;84         OS_ENTER_CRITICAL();
;;;85         pq = (OS_Q *)pevent->OSEventPtr;             /* Point at queue control block                       */
;;;86         if (pq->OSQEntries > 0) {                    /* See if any messages in the queue                   */
;;;87             pmsg = *pq->OSQOut++;                    /* Yes, extract oldest message from the queue         */
;;;88             pq->OSQEntries--;                        /* Update the number of entries in the queue          */
;;;89             if (pq->OSQOut == pq->OSQEnd) {          /* Wrap OUT pointer if we are at the end of the queue */
;;;90                 pq->OSQOut = pq->OSQStart;
;;;91             }
;;;92             *perr = OS_ERR_NONE;
;;;93         } else {
;;;94             *perr = OS_ERR_Q_EMPTY;
;;;95             pmsg  = (void *)0;                       /* Queue is empty                                     */
;;;96         }
;;;97         OS_EXIT_CRITICAL();
;;;98         return (pmsg);                               /* Return message received (or NULL)                  */
;;;99     }
000010  e8bd81f0          POP      {r4-r8,pc}
                  |L1.20|
000014  b91e              CBNZ     r6,|L1.30|
000016  2004              MOVS     r0,#4                 ;76
000018  7028              STRB     r0,[r5,#0]            ;76
00001a  2000              MOVS     r0,#0                 ;77
00001c  e7f8              B        |L1.16|
                  |L1.30|
00001e  7830              LDRB     r0,[r6,#0]            ;80
000020  2802              CMP      r0,#2                 ;80
000022  d003              BEQ      |L1.44|
000024  2001              MOVS     r0,#1                 ;81
000026  7028              STRB     r0,[r5,#0]            ;81
000028  2000              MOVS     r0,#0                 ;82
00002a  e7f1              B        |L1.16|
                  |L1.44|
00002c  f7fffffe          BL       OS_CPU_SR_Save
000030  4680              MOV      r8,r0                 ;84
000032  6874              LDR      r4,[r6,#4]            ;85
000034  8ae0              LDRH     r0,[r4,#0x16]         ;86
000036  2800              CMP      r0,#0                 ;86
000038  dd0f              BLE      |L1.90|
00003a  6921              LDR      r1,[r4,#0x10]         ;87
00003c  1d08              ADDS     r0,r1,#4              ;87
00003e  6120              STR      r0,[r4,#0x10]         ;87
000040  680f              LDR      r7,[r1,#0]            ;87
000042  8ae0              LDRH     r0,[r4,#0x16]         ;88
000044  1e40              SUBS     r0,r0,#1              ;88
000046  82e0              STRH     r0,[r4,#0x16]         ;88
000048  68a1              LDR      r1,[r4,#8]            ;89
00004a  6920              LDR      r0,[r4,#0x10]         ;89
00004c  4288              CMP      r0,r1                 ;89
00004e  d101              BNE      |L1.84|
000050  6860              LDR      r0,[r4,#4]            ;90
000052  6120              STR      r0,[r4,#0x10]         ;90
                  |L1.84|
000054  2000              MOVS     r0,#0                 ;92
000056  7028              STRB     r0,[r5,#0]            ;92
000058  e002              B        |L1.96|
                  |L1.90|
00005a  201f              MOVS     r0,#0x1f              ;94
00005c  7028              STRB     r0,[r5,#0]            ;94
00005e  2700              MOVS     r7,#0                 ;95
                  |L1.96|
000060  4640              MOV      r0,r8                 ;97
000062  f7fffffe          BL       OS_CPU_SR_Restore
000066  4638              MOV      r0,r7                 ;98
000068  e7d2              B        |L1.16|
;;;100    #endif
                          ENDP

                  OSQCreate PROC
;;;120    
;;;121    OS_EVENT  *OSQCreate (void **start, INT16U size)
00006a  e92d41f0          PUSH     {r4-r8,lr}
;;;122    {
00006e  4606              MOV      r6,r0
000070  460f              MOV      r7,r1
;;;123        OS_EVENT  *pevent;
;;;124        OS_Q      *pq;
;;;125    #if OS_CRITICAL_METHOD == 3                      /* Allocate storage for CPU status register           */
;;;126        OS_CPU_SR  cpu_sr = 0;
000072  f04f0800          MOV      r8,#0
;;;127    #endif
;;;128    
;;;129    
;;;130    
;;;131        if (OSIntNesting > 0) {                      /* See if called from ISR ...                         */
000076  48fe              LDR      r0,|L1.1136|
000078  7800              LDRB     r0,[r0,#0]  ; OSIntNesting
00007a  2800              CMP      r0,#0
00007c  dd02              BLE      |L1.132|
;;;132            return ((OS_EVENT *)0);                  /* ... can't CREATE from an ISR                       */
00007e  2000              MOVS     r0,#0
                  |L1.128|
;;;133        }
;;;134        OS_ENTER_CRITICAL();
;;;135        pevent = OSEventFreeList;                    /* Get next free event control block                  */
;;;136        if (OSEventFreeList != (OS_EVENT *)0) {      /* See if pool of free ECB pool was empty             */
;;;137            OSEventFreeList = (OS_EVENT *)OSEventFreeList->OSEventPtr;
;;;138        }
;;;139        OS_EXIT_CRITICAL();
;;;140        if (pevent != (OS_EVENT *)0) {               /* See if we have an event control block              */
;;;141            OS_ENTER_CRITICAL();
;;;142            pq = OSQFreeList;                        /* Get a free queue control block                     */
;;;143            if (pq != (OS_Q *)0) {                   /* Were we able to get a queue control block ?        */
;;;144                OSQFreeList            = OSQFreeList->OSQPtr; /* Yes, Adjust free list pointer to next free*/
;;;145                OS_EXIT_CRITICAL();
;;;146                pq->OSQStart           = start;               /*      Initialize the queue                 */
;;;147                pq->OSQEnd             = &start[size];
;;;148                pq->OSQIn              = start;
;;;149                pq->OSQOut             = start;
;;;150                pq->OSQSize            = size;
;;;151                pq->OSQEntries         = 0;
;;;152                pevent->OSEventType    = OS_EVENT_TYPE_Q;
;;;153                pevent->OSEventCnt     = 0;
;;;154                pevent->OSEventPtr     = pq;
;;;155    #if OS_EVENT_NAME_SIZE > 1
;;;156                pevent->OSEventName[0] = '?';                  /* Unknown name                             */
;;;157                pevent->OSEventName[1] = OS_ASCII_NUL;
;;;158    #endif
;;;159                OS_EventWaitListInit(pevent);                 /*      Initalize the wait list              */
;;;160            } else {
;;;161                pevent->OSEventPtr = (void *)OSEventFreeList; /* No,  Return event control block on error  */
;;;162                OSEventFreeList    = pevent;
;;;163                OS_EXIT_CRITICAL();
;;;164                pevent = (OS_EVENT *)0;
;;;165            }
;;;166        }
;;;167        return (pevent);
;;;168    }
000080  e8bd81f0          POP      {r4-r8,pc}
                  |L1.132|
000084  f7fffffe          BL       OS_CPU_SR_Save
000088  4680              MOV      r8,r0                 ;134
00008a  48fa              LDR      r0,|L1.1140|
00008c  6804              LDR      r4,[r0,#0]            ;135  ; OSEventFreeList
00008e  6800              LDR      r0,[r0,#0]            ;136  ; OSEventFreeList
000090  b120              CBZ      r0,|L1.156|
000092  48f8              LDR      r0,|L1.1140|
000094  6800              LDR      r0,[r0,#0]            ;137  ; OSEventFreeList
000096  6840              LDR      r0,[r0,#4]            ;137
000098  49f6              LDR      r1,|L1.1140|
00009a  6008              STR      r0,[r1,#0]            ;137  ; OSEventFreeList
                  |L1.156|
00009c  4640              MOV      r0,r8                 ;139
00009e  f7fffffe          BL       OS_CPU_SR_Restore
0000a2  b30c              CBZ      r4,|L1.232|
0000a4  f7fffffe          BL       OS_CPU_SR_Save
0000a8  4680              MOV      r8,r0                 ;141
0000aa  48f3              LDR      r0,|L1.1144|
0000ac  6805              LDR      r5,[r0,#0]            ;142  ; OSQFreeList
0000ae  b1e5              CBZ      r5,|L1.234|
0000b0  6800              LDR      r0,[r0,#0]            ;144  ; OSQFreeList
0000b2  6800              LDR      r0,[r0,#0]            ;144
0000b4  49f0              LDR      r1,|L1.1144|
0000b6  6008              STR      r0,[r1,#0]            ;144  ; OSQFreeList
0000b8  4640              MOV      r0,r8                 ;145
0000ba  f7fffffe          BL       OS_CPU_SR_Restore
0000be  606e              STR      r6,[r5,#4]            ;146
0000c0  eb060087          ADD      r0,r6,r7,LSL #2       ;147
0000c4  60a8              STR      r0,[r5,#8]            ;147
0000c6  60ee              STR      r6,[r5,#0xc]          ;148
0000c8  612e              STR      r6,[r5,#0x10]         ;149
0000ca  82af              STRH     r7,[r5,#0x14]         ;150
0000cc  2000              MOVS     r0,#0                 ;151
0000ce  82e8              STRH     r0,[r5,#0x16]         ;151
0000d0  2002              MOVS     r0,#2                 ;152
0000d2  7020              STRB     r0,[r4,#0]            ;152
0000d4  2000              MOVS     r0,#0                 ;153
0000d6  8120              STRH     r0,[r4,#8]            ;153
0000d8  6065              STR      r5,[r4,#4]            ;154
0000da  203f              MOVS     r0,#0x3f              ;156
0000dc  73e0              STRB     r0,[r4,#0xf]          ;156
0000de  2100              MOVS     r1,#0                 ;157
0000e0  7421              STRB     r1,[r4,#0x10]         ;157
0000e2  4620              MOV      r0,r4                 ;159
0000e4  f7fffffe          BL       OS_EventWaitListInit
                  |L1.232|
0000e8  e008              B        |L1.252|
                  |L1.234|
0000ea  48e2              LDR      r0,|L1.1140|
0000ec  6800              LDR      r0,[r0,#0]            ;161  ; OSEventFreeList
0000ee  6060              STR      r0,[r4,#4]            ;161
0000f0  48e0              LDR      r0,|L1.1140|
0000f2  6004              STR      r4,[r0,#0]            ;162  ; OSEventFreeList
0000f4  4640              MOV      r0,r8                 ;163
0000f6  f7fffffe          BL       OS_CPU_SR_Restore
0000fa  2400              MOVS     r4,#0                 ;164
                  |L1.252|
0000fc  4620              MOV      r0,r4                 ;167
0000fe  e7bf              B        |L1.128|
;;;169    /*$PAGE*/
                          ENDP

                  OSQDel PROC
;;;211    #if OS_Q_DEL_EN > 0
;;;212    OS_EVENT  *OSQDel (OS_EVENT *pevent, INT8U opt, INT8U *perr)
000100  e92d47f0          PUSH     {r4-r10,lr}
;;;213    {
000104  4604              MOV      r4,r0
000106  4689              MOV      r9,r1
000108  4615              MOV      r5,r2
;;;214        BOOLEAN    tasks_waiting;
;;;215        OS_EVENT  *pevent_return;
;;;216        OS_Q      *pq;
;;;217    #if OS_CRITICAL_METHOD == 3                                /* Allocate storage for CPU status register */
;;;218        OS_CPU_SR  cpu_sr = 0;
00010a  f04f0a00          MOV      r10,#0
;;;219    #endif
;;;220    
;;;221    
;;;222    
;;;223    #if OS_ARG_CHK_EN > 0
;;;224        if (perr == (INT8U *)0) {                              /* Validate 'perr'                          */
00010e  b915              CBNZ     r5,|L1.278|
;;;225            return (pevent);
000110  4620              MOV      r0,r4
                  |L1.274|
;;;226        }
;;;227        if (pevent == (OS_EVENT *)0) {                         /* Validate 'pevent'                        */
;;;228            *perr = OS_ERR_PEVENT_NULL;
;;;229            return (pevent);
;;;230        }
;;;231    #endif
;;;232        if (pevent->OSEventType != OS_EVENT_TYPE_Q) {          /* Validate event block type                */
;;;233            *perr = OS_ERR_EVENT_TYPE;
;;;234            return (pevent);
;;;235        }
;;;236        if (OSIntNesting > 0) {                                /* See if called from ISR ...               */
;;;237            *perr = OS_ERR_DEL_ISR;                            /* ... can't DELETE from an ISR             */
;;;238            return (pevent);
;;;239        }
;;;240        OS_ENTER_CRITICAL();
;;;241        if (pevent->OSEventGrp != 0) {                         /* See if any tasks waiting on queue        */
;;;242            tasks_waiting = OS_TRUE;                           /* Yes                                      */
;;;243        } else {
;;;244            tasks_waiting = OS_FALSE;                          /* No                                       */
;;;245        }
;;;246        switch (opt) {
;;;247            case OS_DEL_NO_PEND:                               /* Delete queue only if no task waiting     */
;;;248                 if (tasks_waiting == OS_FALSE) {
;;;249    #if OS_EVENT_NAME_SIZE > 1
;;;250                     pevent->OSEventName[0] = '?';             /* Unknown name                             */
;;;251                     pevent->OSEventName[1] = OS_ASCII_NUL;
;;;252    #endif
;;;253                     pq                     = (OS_Q *)pevent->OSEventPtr;  /* Return OS_Q to free list     */
;;;254                     pq->OSQPtr             = OSQFreeList;
;;;255                     OSQFreeList            = pq;
;;;256                     pevent->OSEventType    = OS_EVENT_TYPE_UNUSED;
;;;257                     pevent->OSEventPtr     = OSEventFreeList; /* Return Event Control Block to free list  */
;;;258                     pevent->OSEventCnt     = 0;
;;;259                     OSEventFreeList        = pevent;          /* Get next free event control block        */
;;;260                     OS_EXIT_CRITICAL();
;;;261                     *perr                  = OS_ERR_NONE;
;;;262                     pevent_return          = (OS_EVENT *)0;   /* Queue has been deleted                   */
;;;263                 } else {
;;;264                     OS_EXIT_CRITICAL();
;;;265                     *perr                  = OS_ERR_TASK_WAITING;
;;;266                     pevent_return          = pevent;
;;;267                 }
;;;268                 break;
;;;269    
;;;270            case OS_DEL_ALWAYS:                                /* Always delete the queue                  */
;;;271                 while (pevent->OSEventGrp != 0) {             /* Ready ALL tasks waiting for queue        */
;;;272                     (void)OS_EventTaskRdy(pevent, (void *)0, OS_STAT_Q, OS_STAT_PEND_OK);
;;;273                 }
;;;274    #if OS_EVENT_NAME_SIZE > 1
;;;275                 pevent->OSEventName[0] = '?';                 /* Unknown name                             */
;;;276                 pevent->OSEventName[1] = OS_ASCII_NUL;
;;;277    #endif
;;;278                 pq                     = (OS_Q *)pevent->OSEventPtr;   /* Return OS_Q to free list        */
;;;279                 pq->OSQPtr             = OSQFreeList;
;;;280                 OSQFreeList            = pq;
;;;281                 pevent->OSEventType    = OS_EVENT_TYPE_UNUSED;
;;;282                 pevent->OSEventPtr     = OSEventFreeList;     /* Return Event Control Block to free list  */
;;;283                 pevent->OSEventCnt     = 0;
;;;284                 OSEventFreeList        = pevent;              /* Get next free event control block        */
;;;285                 OS_EXIT_CRITICAL();
;;;286                 if (tasks_waiting == OS_TRUE) {               /* Reschedule only if task(s) were waiting  */
;;;287                     OS_Sched();                               /* Find highest priority task ready to run  */
;;;288                 }
;;;289                 *perr                  = OS_ERR_NONE;
;;;290                 pevent_return          = (OS_EVENT *)0;       /* Queue has been deleted                   */
;;;291                 break;
;;;292    
;;;293            default:
;;;294                 OS_EXIT_CRITICAL();
;;;295                 *perr                  = OS_ERR_INVALID_OPT;
;;;296                 pevent_return          = pevent;
;;;297                 break;
;;;298        }
;;;299        return (pevent_return);
;;;300    }
000112  e8bd87f0          POP      {r4-r10,pc}
                  |L1.278|
000116  b91c              CBNZ     r4,|L1.288|
000118  2004              MOVS     r0,#4                 ;228
00011a  7028              STRB     r0,[r5,#0]            ;228
00011c  4620              MOV      r0,r4                 ;229
00011e  e7f8              B        |L1.274|
                  |L1.288|
000120  7820              LDRB     r0,[r4,#0]            ;232
000122  2802              CMP      r0,#2                 ;232
000124  d003              BEQ      |L1.302|
000126  2001              MOVS     r0,#1                 ;233
000128  7028              STRB     r0,[r5,#0]            ;233
00012a  4620              MOV      r0,r4                 ;234
00012c  e7f1              B        |L1.274|
                  |L1.302|
00012e  48d0              LDR      r0,|L1.1136|
000130  7800              LDRB     r0,[r0,#0]            ;236  ; OSIntNesting
000132  2800              CMP      r0,#0                 ;236
000134  dd03              BLE      |L1.318|
000136  200f              MOVS     r0,#0xf               ;237
000138  7028              STRB     r0,[r5,#0]            ;237
00013a  4620              MOV      r0,r4                 ;238
00013c  e7e9              B        |L1.274|
                  |L1.318|
00013e  f7fffffe          BL       OS_CPU_SR_Save
000142  4682              MOV      r10,r0                ;240
000144  7aa0              LDRB     r0,[r4,#0xa]          ;241
000146  b110              CBZ      r0,|L1.334|
000148  f04f0801          MOV      r8,#1                 ;242
00014c  e001              B        |L1.338|
                  |L1.334|
00014e  f04f0800          MOV      r8,#0                 ;244
                  |L1.338|
000152  f1b90f00          CMP      r9,#0                 ;246
000156  d003              BEQ      |L1.352|
000158  f1b90f01          CMP      r9,#1                 ;246
00015c  d14d              BNE      |L1.506|
00015e  e023              B        |L1.424|
                  |L1.352|
000160  f1b80f00          CMP      r8,#0                 ;248
000164  d119              BNE      |L1.410|
000166  203f              MOVS     r0,#0x3f              ;250
000168  73e0              STRB     r0,[r4,#0xf]          ;250
00016a  2100              MOVS     r1,#0                 ;251
00016c  7421              STRB     r1,[r4,#0x10]         ;251
00016e  6866              LDR      r6,[r4,#4]            ;253
000170  48c1              LDR      r0,|L1.1144|
000172  6800              LDR      r0,[r0,#0]            ;254  ; OSQFreeList
000174  6030              STR      r0,[r6,#0]            ;254
000176  48c0              LDR      r0,|L1.1144|
000178  6006              STR      r6,[r0,#0]            ;255  ; OSQFreeList
00017a  2000              MOVS     r0,#0                 ;256
00017c  7020              STRB     r0,[r4,#0]            ;256
00017e  48bd              LDR      r0,|L1.1140|
000180  6800              LDR      r0,[r0,#0]            ;257  ; OSEventFreeList
000182  6060              STR      r0,[r4,#4]            ;257
000184  2000              MOVS     r0,#0                 ;258
000186  8120              STRH     r0,[r4,#8]            ;258
000188  48ba              LDR      r0,|L1.1140|
00018a  6004              STR      r4,[r0,#0]            ;259  ; OSEventFreeList
00018c  4650              MOV      r0,r10                ;260
00018e  f7fffffe          BL       OS_CPU_SR_Restore
000192  2000              MOVS     r0,#0                 ;261
000194  7028              STRB     r0,[r5,#0]            ;261
000196  2700              MOVS     r7,#0                 ;262
000198  e005              B        |L1.422|
                  |L1.410|
00019a  4650              MOV      r0,r10                ;264
00019c  f7fffffe          BL       OS_CPU_SR_Restore
0001a0  2049              MOVS     r0,#0x49              ;265
0001a2  7028              STRB     r0,[r5,#0]            ;265
0001a4  4627              MOV      r7,r4                 ;266
                  |L1.422|
0001a6  e02f              B        |L1.520|
                  |L1.424|
0001a8  e005              B        |L1.438|
                  |L1.426|
0001aa  2300              MOVS     r3,#0                 ;272
0001ac  2204              MOVS     r2,#4                 ;272
0001ae  4619              MOV      r1,r3                 ;272
0001b0  4620              MOV      r0,r4                 ;272
0001b2  f7fffffe          BL       OS_EventTaskRdy
                  |L1.438|
0001b6  7aa0              LDRB     r0,[r4,#0xa]          ;271
0001b8  2800              CMP      r0,#0                 ;271
0001ba  d1f6              BNE      |L1.426|
0001bc  203f              MOVS     r0,#0x3f              ;275
0001be  73e0              STRB     r0,[r4,#0xf]          ;275
0001c0  2100              MOVS     r1,#0                 ;276
0001c2  7421              STRB     r1,[r4,#0x10]         ;276
0001c4  6866              LDR      r6,[r4,#4]            ;278
0001c6  48ac              LDR      r0,|L1.1144|
0001c8  6800              LDR      r0,[r0,#0]            ;279  ; OSQFreeList
0001ca  6030              STR      r0,[r6,#0]            ;279
0001cc  48aa              LDR      r0,|L1.1144|
0001ce  6006              STR      r6,[r0,#0]            ;280  ; OSQFreeList
0001d0  2000              MOVS     r0,#0                 ;281
0001d2  7020              STRB     r0,[r4,#0]            ;281
0001d4  48a7              LDR      r0,|L1.1140|
0001d6  6800              LDR      r0,[r0,#0]            ;282  ; OSEventFreeList
0001d8  6060              STR      r0,[r4,#4]            ;282
0001da  2000              MOVS     r0,#0                 ;283
0001dc  8120              STRH     r0,[r4,#8]            ;283
0001de  48a5              LDR      r0,|L1.1140|
0001e0  6004              STR      r4,[r0,#0]            ;284  ; OSEventFreeList
0001e2  4650              MOV      r0,r10                ;285
0001e4  f7fffffe          BL       OS_CPU_SR_Restore
0001e8  f1b80f01          CMP      r8,#1                 ;286
0001ec  d101              BNE      |L1.498|
0001ee  f7fffffe          BL       OS_Sched
                  |L1.498|
0001f2  2000              MOVS     r0,#0                 ;289
0001f4  7028              STRB     r0,[r5,#0]            ;289
0001f6  2700              MOVS     r7,#0                 ;290
0001f8  e006              B        |L1.520|
                  |L1.506|
0001fa  4650              MOV      r0,r10                ;294
0001fc  f7fffffe          BL       OS_CPU_SR_Restore
000200  2007              MOVS     r0,#7                 ;295
000202  7028              STRB     r0,[r5,#0]            ;295
000204  4627              MOV      r7,r4                 ;296
000206  bf00              NOP                            ;297
                  |L1.520|
000208  bf00              NOP                            ;268
00020a  4638              MOV      r0,r7                 ;299
00020c  e781              B        |L1.274|
;;;301    #endif
                          ENDP

                  OSQFlush PROC
;;;323    #if OS_Q_FLUSH_EN > 0
;;;324    INT8U  OSQFlush (OS_EVENT *pevent)
00020e  b570              PUSH     {r4-r6,lr}
;;;325    {
000210  4605              MOV      r5,r0
;;;326        OS_Q      *pq;
;;;327    #if OS_CRITICAL_METHOD == 3                           /* Allocate storage for CPU status register      */
;;;328        OS_CPU_SR  cpu_sr = 0;
000212  2600              MOVS     r6,#0
;;;329    #endif
;;;330    
;;;331    
;;;332    
;;;333    #if OS_ARG_CHK_EN > 0
;;;334        if (pevent == (OS_EVENT *)0) {                    /* Validate 'pevent'                             */
000214  b90d              CBNZ     r5,|L1.538|
;;;335            return (OS_ERR_PEVENT_NULL);
000216  2004              MOVS     r0,#4
                  |L1.536|
;;;336        }
;;;337        if (pevent->OSEventType != OS_EVENT_TYPE_Q) {     /* Validate event block type                     */
;;;338            return (OS_ERR_EVENT_TYPE);
;;;339        }
;;;340    #endif
;;;341        OS_ENTER_CRITICAL();
;;;342        pq             = (OS_Q *)pevent->OSEventPtr;      /* Point to queue storage structure              */
;;;343        pq->OSQIn      = pq->OSQStart;
;;;344        pq->OSQOut     = pq->OSQStart;
;;;345        pq->OSQEntries = 0;
;;;346        OS_EXIT_CRITICAL();
;;;347        return (OS_ERR_NONE);
;;;348    }
000218  bd70              POP      {r4-r6,pc}
                  |L1.538|
00021a  7828              LDRB     r0,[r5,#0]            ;337
00021c  2802              CMP      r0,#2                 ;337
00021e  d001              BEQ      |L1.548|
000220  2001              MOVS     r0,#1                 ;338
000222  e7f9              B        |L1.536|
                  |L1.548|
000224  f7fffffe          BL       OS_CPU_SR_Save
000228  4606              MOV      r6,r0                 ;341
00022a  686c              LDR      r4,[r5,#4]            ;342
00022c  6860              LDR      r0,[r4,#4]            ;343
00022e  60e0              STR      r0,[r4,#0xc]          ;343
000230  6860              LDR      r0,[r4,#4]            ;344
000232  6120              STR      r0,[r4,#0x10]         ;344
000234  2000              MOVS     r0,#0                 ;345
000236  82e0              STRH     r0,[r4,#0x16]         ;345
000238  4630              MOV      r0,r6                 ;346
00023a  f7fffffe          BL       OS_CPU_SR_Restore
00023e  2000              MOVS     r0,#0                 ;347
000240  e7ea              B        |L1.536|
;;;349    #endif
                          ENDP

                  OSQPend PROC
;;;387    
;;;388    void  *OSQPend (OS_EVENT *pevent, INT16U timeout, INT8U *perr)
000242  e92d47f0          PUSH     {r4-r10,lr}
;;;389    {
000246  4606              MOV      r6,r0
000248  4688              MOV      r8,r1
00024a  4615              MOV      r5,r2
;;;390        void      *pmsg;
;;;391        OS_Q      *pq;
;;;392    #if OS_CRITICAL_METHOD == 3                      /* Allocate storage for CPU status register           */
;;;393        OS_CPU_SR  cpu_sr = 0;
00024c  f04f0900          MOV      r9,#0
;;;394    #endif
;;;395    
;;;396    
;;;397    
;;;398    #if OS_ARG_CHK_EN > 0
;;;399        if (perr == (INT8U *)0) {                    /* Validate 'perr'                                    */
000250  b915              CBNZ     r5,|L1.600|
;;;400            return ((void *)0);
000252  2000              MOVS     r0,#0
                  |L1.596|
;;;401        }
;;;402        if (pevent == (OS_EVENT *)0) {               /* Validate 'pevent'                                  */
;;;403            *perr = OS_ERR_PEVENT_NULL;
;;;404            return ((void *)0);
;;;405        }
;;;406    #endif
;;;407        if (pevent->OSEventType != OS_EVENT_TYPE_Q) {/* Validate event block type                          */
;;;408            *perr = OS_ERR_EVENT_TYPE;
;;;409            return ((void *)0);
;;;410        }
;;;411        if (OSIntNesting > 0) {                      /* See if called from ISR ...                         */
;;;412            *perr = OS_ERR_PEND_ISR;                 /* ... can't PEND from an ISR                         */
;;;413            return ((void *)0);
;;;414        }
;;;415        if (OSLockNesting > 0) {                     /* See if called with scheduler locked ...            */
;;;416            *perr = OS_ERR_PEND_LOCKED;              /* ... can't PEND when locked                         */
;;;417            return ((void *)0);
;;;418        }
;;;419        OS_ENTER_CRITICAL();
;;;420        pq = (OS_Q *)pevent->OSEventPtr;             /* Point at queue control block                       */
;;;421        if (pq->OSQEntries > 0) {                    /* See if any messages in the queue                   */
;;;422            pmsg = *pq->OSQOut++;                    /* Yes, extract oldest message from the queue         */
;;;423            pq->OSQEntries--;                        /* Update the number of entries in the queue          */
;;;424            if (pq->OSQOut == pq->OSQEnd) {          /* Wrap OUT pointer if we are at the end of the queue */
;;;425                pq->OSQOut = pq->OSQStart;
;;;426            }
;;;427            OS_EXIT_CRITICAL();
;;;428            *perr = OS_ERR_NONE;
;;;429            return (pmsg);                           /* Return message received                            */
;;;430        }
;;;431        OSTCBCur->OSTCBStat     |= OS_STAT_Q;        /* Task will have to pend for a message to be posted  */
;;;432        OSTCBCur->OSTCBStatPend  = OS_STAT_PEND_OK;
;;;433        OSTCBCur->OSTCBDly       = timeout;          /* Load timeout into TCB                              */
;;;434        OS_EventTaskWait(pevent);                    /* Suspend task until event or timeout occurs         */
;;;435        OS_EXIT_CRITICAL();
;;;436        OS_Sched();                                  /* Find next highest priority task ready to run       */
;;;437        OS_ENTER_CRITICAL();
;;;438        switch (OSTCBCur->OSTCBStatPend) {                /* See if we timed-out or aborted                */
;;;439            case OS_STAT_PEND_OK:                         /* Extract message from TCB (Put there by QPost) */
;;;440                 pmsg =  OSTCBCur->OSTCBMsg;
;;;441                *perr =  OS_ERR_NONE;
;;;442                 break;
;;;443    
;;;444            case OS_STAT_PEND_ABORT:
;;;445                 pmsg = (void *)0;
;;;446                *perr =  OS_ERR_PEND_ABORT;               /* Indicate that we aborted                      */
;;;447                 break;
;;;448    
;;;449            case OS_STAT_PEND_TO:
;;;450            default:
;;;451                 OS_EventTaskRemove(OSTCBCur, pevent);
;;;452                 pmsg = (void *)0;
;;;453                *perr =  OS_ERR_TIMEOUT;                  /* Indicate that we didn't get event within TO   */
;;;454                 break;
;;;455        }
;;;456        OSTCBCur->OSTCBStat          =  OS_STAT_RDY;      /* Set   task  status to ready                   */
;;;457        OSTCBCur->OSTCBStatPend      =  OS_STAT_PEND_OK;  /* Clear pend  status                            */
;;;458        OSTCBCur->OSTCBEventPtr      = (OS_EVENT  *)0;    /* Clear event pointers                          */
;;;459    #if (OS_EVENT_MULTI_EN > 0)
;;;460        OSTCBCur->OSTCBEventMultiPtr = (OS_EVENT **)0;
;;;461    #endif
;;;462        OSTCBCur->OSTCBMsg           = (void      *)0;    /* Clear  received message                       */
;;;463        OS_EXIT_CRITICAL();
;;;464        return (pmsg);                                    /* Return received message                       */
;;;465    }
000254  e8bd87f0          POP      {r4-r10,pc}
                  |L1.600|
000258  b91e              CBNZ     r6,|L1.610|
00025a  2004              MOVS     r0,#4                 ;403
00025c  7028              STRB     r0,[r5,#0]            ;403
00025e  2000              MOVS     r0,#0                 ;404
000260  e7f8              B        |L1.596|
                  |L1.610|
000262  7830              LDRB     r0,[r6,#0]            ;407
000264  2802              CMP      r0,#2                 ;407
000266  d003              BEQ      |L1.624|
000268  2001              MOVS     r0,#1                 ;408
00026a  7028              STRB     r0,[r5,#0]            ;408
00026c  2000              MOVS     r0,#0                 ;409
00026e  e7f1              B        |L1.596|
                  |L1.624|
000270  487f              LDR      r0,|L1.1136|
000272  7800              LDRB     r0,[r0,#0]            ;411  ; OSIntNesting
000274  2800              CMP      r0,#0                 ;411
000276  dd03              BLE      |L1.640|
000278  2002              MOVS     r0,#2                 ;412
00027a  7028              STRB     r0,[r5,#0]            ;412
00027c  2000              MOVS     r0,#0                 ;413
00027e  e7e9              B        |L1.596|
                  |L1.640|
000280  487e              LDR      r0,|L1.1148|
000282  7800              LDRB     r0,[r0,#0]            ;415  ; OSLockNesting
000284  2800              CMP      r0,#0                 ;415
000286  dd03              BLE      |L1.656|
000288  200d              MOVS     r0,#0xd               ;416
00028a  7028              STRB     r0,[r5,#0]            ;416
00028c  2000              MOVS     r0,#0                 ;417
00028e  e7e1              B        |L1.596|
                  |L1.656|
000290  f7fffffe          BL       OS_CPU_SR_Save
000294  4681              MOV      r9,r0                 ;419
000296  6874              LDR      r4,[r6,#4]            ;420
000298  8ae0              LDRH     r0,[r4,#0x16]         ;421
00029a  2800              CMP      r0,#0                 ;421
00029c  dd13              BLE      |L1.710|
00029e  6921              LDR      r1,[r4,#0x10]         ;422
0002a0  1d08              ADDS     r0,r1,#4              ;422
0002a2  6120              STR      r0,[r4,#0x10]         ;422
0002a4  680f              LDR      r7,[r1,#0]            ;422
0002a6  8ae0              LDRH     r0,[r4,#0x16]         ;423
0002a8  1e40              SUBS     r0,r0,#1              ;423
0002aa  82e0              STRH     r0,[r4,#0x16]         ;423
0002ac  68a1              LDR      r1,[r4,#8]            ;424
0002ae  6920              LDR      r0,[r4,#0x10]         ;424
0002b0  4288              CMP      r0,r1                 ;424
0002b2  d101              BNE      |L1.696|
0002b4  6860              LDR      r0,[r4,#4]            ;425
0002b6  6120              STR      r0,[r4,#0x10]         ;425
                  |L1.696|
0002b8  4648              MOV      r0,r9                 ;427
0002ba  f7fffffe          BL       OS_CPU_SR_Restore
0002be  2000              MOVS     r0,#0                 ;428
0002c0  7028              STRB     r0,[r5,#0]            ;428
0002c2  4638              MOV      r0,r7                 ;429
0002c4  e7c6              B        |L1.596|
                  |L1.710|
0002c6  486e              LDR      r0,|L1.1152|
0002c8  6800              LDR      r0,[r0,#0]            ;431  ; OSTCBCur
0002ca  f890002c          LDRB     r0,[r0,#0x2c]         ;431
0002ce  f0400004          ORR      r0,r0,#4              ;431
0002d2  496b              LDR      r1,|L1.1152|
0002d4  6809              LDR      r1,[r1,#0]            ;431  ; OSTCBCur
0002d6  f881002c          STRB     r0,[r1,#0x2c]         ;431
0002da  2000              MOVS     r0,#0                 ;432
0002dc  4968              LDR      r1,|L1.1152|
0002de  6809              LDR      r1,[r1,#0]            ;432  ; OSTCBCur
0002e0  f881002d          STRB     r0,[r1,#0x2d]         ;432
0002e4  4866              LDR      r0,|L1.1152|
0002e6  6800              LDR      r0,[r0,#0]            ;433  ; OSTCBCur
0002e8  f8a0802a          STRH     r8,[r0,#0x2a]         ;433
0002ec  4630              MOV      r0,r6                 ;434
0002ee  f7fffffe          BL       OS_EventTaskWait
0002f2  4648              MOV      r0,r9                 ;435
0002f4  f7fffffe          BL       OS_CPU_SR_Restore
0002f8  f7fffffe          BL       OS_Sched
0002fc  f7fffffe          BL       OS_CPU_SR_Save
000300  4681              MOV      r9,r0                 ;437
000302  485f              LDR      r0,|L1.1152|
000304  6800              LDR      r0,[r0,#0]            ;438  ; OSTCBCur
000306  f890002d          LDRB     r0,[r0,#0x2d]         ;438
00030a  b120              CBZ      r0,|L1.790|
00030c  2801              CMP      r0,#1                 ;438
00030e  d00d              BEQ      |L1.812|
000310  2802              CMP      r0,#2                 ;438
000312  d10a              BNE      |L1.810|
000314  e005              B        |L1.802|
                  |L1.790|
000316  485a              LDR      r0,|L1.1152|
000318  6800              LDR      r0,[r0,#0]            ;440  ; OSTCBCur
00031a  6a07              LDR      r7,[r0,#0x20]         ;440
00031c  2000              MOVS     r0,#0                 ;441
00031e  7028              STRB     r0,[r5,#0]            ;441
000320  e00d              B        |L1.830|
                  |L1.802|
000322  2700              MOVS     r7,#0                 ;445
000324  200e              MOVS     r0,#0xe               ;446
000326  7028              STRB     r0,[r5,#0]            ;446
000328  e009              B        |L1.830|
                  |L1.810|
00032a  bf00              NOP                            ;449
                  |L1.812|
00032c  4631              MOV      r1,r6                 ;451
00032e  4854              LDR      r0,|L1.1152|
000330  6800              LDR      r0,[r0,#0]            ;451  ; OSTCBCur
000332  f7fffffe          BL       OS_EventTaskRemove
000336  2700              MOVS     r7,#0                 ;452
000338  200a              MOVS     r0,#0xa               ;453
00033a  7028              STRB     r0,[r5,#0]            ;453
00033c  bf00              NOP                            ;454
                  |L1.830|
00033e  bf00              NOP                            ;442
000340  2000              MOVS     r0,#0                 ;456
000342  494f              LDR      r1,|L1.1152|
000344  6809              LDR      r1,[r1,#0]            ;456  ; OSTCBCur
000346  f881002c          STRB     r0,[r1,#0x2c]         ;456
00034a  494d              LDR      r1,|L1.1152|
00034c  6809              LDR      r1,[r1,#0]            ;457  ; OSTCBCur
00034e  f881002d          STRB     r0,[r1,#0x2d]         ;457
000352  494b              LDR      r1,|L1.1152|
000354  6809              LDR      r1,[r1,#0]            ;458  ; OSTCBCur
000356  61c8              STR      r0,[r1,#0x1c]         ;458
000358  4949              LDR      r1,|L1.1152|
00035a  6809              LDR      r1,[r1,#0]            ;462  ; OSTCBCur
00035c  6208              STR      r0,[r1,#0x20]         ;462
00035e  4648              MOV      r0,r9                 ;463
000360  f7fffffe          BL       OS_CPU_SR_Restore
000364  4638              MOV      r0,r7                 ;464
000366  e775              B        |L1.596|
;;;466    /*$PAGE*/
                          ENDP

                  OSQPendAbort PROC
;;;499    #if OS_Q_PEND_ABORT_EN > 0
;;;500    INT8U  OSQPendAbort (OS_EVENT *pevent, INT8U opt, INT8U *perr)
000368  e92d41f0          PUSH     {r4-r8,lr}
;;;501    {
00036c  4605              MOV      r5,r0
00036e  460f              MOV      r7,r1
000370  4614              MOV      r4,r2
;;;502        INT8U      nbr_tasks;
;;;503    #if OS_CRITICAL_METHOD == 3                                /* Allocate storage for CPU status register */
;;;504        OS_CPU_SR  cpu_sr = 0;
000372  f04f0800          MOV      r8,#0
;;;505    #endif
;;;506    
;;;507    
;;;508    
;;;509    #if OS_ARG_CHK_EN > 0
;;;510        if (perr == (INT8U *)0) {                              /* Validate 'perr'                          */
000376  b914              CBNZ     r4,|L1.894|
;;;511            return (0);
000378  2000              MOVS     r0,#0
                  |L1.890|
;;;512        }
;;;513        if (pevent == (OS_EVENT *)0) {                         /* Validate 'pevent'                        */
;;;514            *perr = OS_ERR_PEVENT_NULL;
;;;515            return (0);
;;;516        }
;;;517    #endif
;;;518        if (pevent->OSEventType != OS_EVENT_TYPE_Q) {          /* Validate event block type                */
;;;519            *perr = OS_ERR_EVENT_TYPE;
;;;520            return (0);
;;;521        }
;;;522        OS_ENTER_CRITICAL();
;;;523        if (pevent->OSEventGrp != 0) {                         /* See if any task waiting on queue?        */
;;;524            nbr_tasks = 0;
;;;525            switch (opt) {
;;;526                case OS_PEND_OPT_BROADCAST:                    /* Do we need to abort ALL waiting tasks?   */
;;;527                     while (pevent->OSEventGrp != 0) {         /* Yes, ready ALL tasks waiting on queue    */
;;;528                         (void)OS_EventTaskRdy(pevent, (void *)0, OS_STAT_Q, OS_STAT_PEND_ABORT);
;;;529                         nbr_tasks++;
;;;530                     }
;;;531                     break;
;;;532                   
;;;533                case OS_PEND_OPT_NONE:
;;;534                default:                                       /* No,  ready HPT       waiting on queue    */
;;;535                     (void)OS_EventTaskRdy(pevent, (void *)0, OS_STAT_Q, OS_STAT_PEND_ABORT);
;;;536                     nbr_tasks++;
;;;537                     break;
;;;538            }
;;;539            OS_EXIT_CRITICAL();
;;;540            OS_Sched();                                        /* Find HPT ready to run                    */
;;;541            *perr = OS_ERR_PEND_ABORT;
;;;542            return (nbr_tasks);
;;;543        }
;;;544        OS_EXIT_CRITICAL();
;;;545        *perr = OS_ERR_NONE;
;;;546        return (0);                                            /* No tasks waiting on queue                */
;;;547    }
00037a  e8bd81f0          POP      {r4-r8,pc}
                  |L1.894|
00037e  b91d              CBNZ     r5,|L1.904|
000380  2004              MOVS     r0,#4                 ;514
000382  7020              STRB     r0,[r4,#0]            ;514
000384  2000              MOVS     r0,#0                 ;515
000386  e7f8              B        |L1.890|
                  |L1.904|
000388  7828              LDRB     r0,[r5,#0]            ;518
00038a  2802              CMP      r0,#2                 ;518
00038c  d003              BEQ      |L1.918|
00038e  2001              MOVS     r0,#1                 ;519
000390  7020              STRB     r0,[r4,#0]            ;519
000392  2000              MOVS     r0,#0                 ;520
000394  e7f1              B        |L1.890|
                  |L1.918|
000396  f7fffffe          BL       OS_CPU_SR_Save
00039a  4680              MOV      r8,r0                 ;522
00039c  7aa8              LDRB     r0,[r5,#0xa]          ;523
00039e  b320              CBZ      r0,|L1.1002|
0003a0  2600              MOVS     r6,#0                 ;524
0003a2  b17f              CBZ      r7,|L1.964|
0003a4  2f01              CMP      r7,#1                 ;525
0003a6  d10c              BNE      |L1.962|
0003a8  e007              B        |L1.954|
                  |L1.938|
0003aa  2302              MOVS     r3,#2                 ;528
0003ac  2204              MOVS     r2,#4                 ;528
0003ae  2100              MOVS     r1,#0                 ;528
0003b0  4628              MOV      r0,r5                 ;528
0003b2  f7fffffe          BL       OS_EventTaskRdy
0003b6  1c70              ADDS     r0,r6,#1              ;529
0003b8  b2c6              UXTB     r6,r0                 ;529
                  |L1.954|
0003ba  7aa8              LDRB     r0,[r5,#0xa]          ;527
0003bc  2800              CMP      r0,#0                 ;527
0003be  d1f4              BNE      |L1.938|
0003c0  e009              B        |L1.982|
                  |L1.962|
0003c2  bf00              NOP                            ;533
                  |L1.964|
0003c4  2302              MOVS     r3,#2                 ;535
0003c6  2204              MOVS     r2,#4                 ;535
0003c8  2100              MOVS     r1,#0                 ;535
0003ca  4628              MOV      r0,r5                 ;535
0003cc  f7fffffe          BL       OS_EventTaskRdy
0003d0  1c70              ADDS     r0,r6,#1              ;536
0003d2  b2c6              UXTB     r6,r0                 ;536
0003d4  bf00              NOP                            ;537
                  |L1.982|
0003d6  bf00              NOP                            ;531
0003d8  4640              MOV      r0,r8                 ;539
0003da  f7fffffe          BL       OS_CPU_SR_Restore
0003de  f7fffffe          BL       OS_Sched
0003e2  200e              MOVS     r0,#0xe               ;541
0003e4  7020              STRB     r0,[r4,#0]            ;541
0003e6  4630              MOV      r0,r6                 ;542
0003e8  e7c7              B        |L1.890|
                  |L1.1002|
0003ea  4640              MOV      r0,r8                 ;544
0003ec  f7fffffe          BL       OS_CPU_SR_Restore
0003f0  2000              MOVS     r0,#0                 ;545
0003f2  7020              STRB     r0,[r4,#0]            ;545
0003f4  bf00              NOP                            ;546
0003f6  e7c0              B        |L1.890|
;;;548    #endif
                          ENDP

                  OSQPost PROC
;;;570    #if OS_Q_POST_EN > 0
;;;571    INT8U  OSQPost (OS_EVENT *pevent, void *pmsg)
0003f8  e92d41f0          PUSH     {r4-r8,lr}
;;;572    {
0003fc  4605              MOV      r5,r0
0003fe  460e              MOV      r6,r1
;;;573        OS_Q      *pq;
;;;574    #if OS_CRITICAL_METHOD == 3                            /* Allocate storage for CPU status register     */
;;;575        OS_CPU_SR  cpu_sr = 0;
000400  2700              MOVS     r7,#0
;;;576    #endif
;;;577    
;;;578    
;;;579    
;;;580    #if OS_ARG_CHK_EN > 0
;;;581        if (pevent == (OS_EVENT *)0) {                     /* Validate 'pevent'                            */
000402  b915              CBNZ     r5,|L1.1034|
;;;582            return (OS_ERR_PEVENT_NULL);
000404  2004              MOVS     r0,#4
                  |L1.1030|
;;;583        }
;;;584    #endif
;;;585        if (pevent->OSEventType != OS_EVENT_TYPE_Q) {      /* Validate event block type                    */
;;;586            return (OS_ERR_EVENT_TYPE);
;;;587        }
;;;588        OS_ENTER_CRITICAL();
;;;589        if (pevent->OSEventGrp != 0) {                     /* See if any task pending on queue             */
;;;590                                                           /* Ready highest priority task waiting on event */
;;;591            (void)OS_EventTaskRdy(pevent, pmsg, OS_STAT_Q, OS_STAT_PEND_OK);
;;;592            OS_EXIT_CRITICAL();
;;;593            OS_Sched();                                    /* Find highest priority task ready to run      */
;;;594            return (OS_ERR_NONE);
;;;595        }
;;;596        pq = (OS_Q *)pevent->OSEventPtr;                   /* Point to queue control block                 */
;;;597        if (pq->OSQEntries >= pq->OSQSize) {               /* Make sure queue is not full                  */
;;;598            OS_EXIT_CRITICAL();
;;;599            return (OS_ERR_Q_FULL);
;;;600        }
;;;601        *pq->OSQIn++ = pmsg;                               /* Insert message into queue                    */
;;;602        pq->OSQEntries++;                                  /* Update the nbr of entries in the queue       */
;;;603        if (pq->OSQIn == pq->OSQEnd) {                     /* Wrap IN ptr if we are at end of queue        */
;;;604            pq->OSQIn = pq->OSQStart;
;;;605        }
;;;606        OS_EXIT_CRITICAL();
;;;607        return (OS_ERR_NONE);
;;;608    }
000406  e8bd81f0          POP      {r4-r8,pc}
                  |L1.1034|
00040a  7828              LDRB     r0,[r5,#0]            ;585
00040c  2802              CMP      r0,#2                 ;585
00040e  d001              BEQ      |L1.1044|
000410  2001              MOVS     r0,#1                 ;586
000412  e7f8              B        |L1.1030|
                  |L1.1044|
000414  f7fffffe          BL       OS_CPU_SR_Save
000418  4607              MOV      r7,r0                 ;588
00041a  7aa8              LDRB     r0,[r5,#0xa]          ;589
00041c  b160              CBZ      r0,|L1.1080|
00041e  2300              MOVS     r3,#0                 ;591
000420  2204              MOVS     r2,#4                 ;591
000422  4631              MOV      r1,r6                 ;591
000424  4628              MOV      r0,r5                 ;591
000426  f7fffffe          BL       OS_EventTaskRdy
00042a  4638              MOV      r0,r7                 ;592
00042c  f7fffffe          BL       OS_CPU_SR_Restore
000430  f7fffffe          BL       OS_Sched
000434  2000              MOVS     r0,#0                 ;594
000436  e7e6              B        |L1.1030|
                  |L1.1080|
000438  686c              LDR      r4,[r5,#4]            ;596
00043a  8ae0              LDRH     r0,[r4,#0x16]         ;597
00043c  8aa1              LDRH     r1,[r4,#0x14]         ;597
00043e  4288              CMP      r0,r1                 ;597
000440  db04              BLT      |L1.1100|
000442  4638              MOV      r0,r7                 ;598
000444  f7fffffe          BL       OS_CPU_SR_Restore
000448  201e              MOVS     r0,#0x1e              ;599
00044a  e7dc              B        |L1.1030|
                  |L1.1100|
00044c  68e1              LDR      r1,[r4,#0xc]          ;601
00044e  1d08              ADDS     r0,r1,#4              ;601
000450  60e0              STR      r0,[r4,#0xc]          ;601
000452  600e              STR      r6,[r1,#0]            ;601
000454  8ae0              LDRH     r0,[r4,#0x16]         ;602
000456  1c40              ADDS     r0,r0,#1              ;602
000458  82e0              STRH     r0,[r4,#0x16]         ;602
00045a  e9d41002          LDRD     r1,r0,[r4,#8]         ;603
00045e  4288              CMP      r0,r1                 ;603
000460  d101              BNE      |L1.1126|
000462  6860              LDR      r0,[r4,#4]            ;604
000464  60e0              STR      r0,[r4,#0xc]          ;604
                  |L1.1126|
000466  4638              MOV      r0,r7                 ;606
000468  f7fffffe          BL       OS_CPU_SR_Restore
00046c  2000              MOVS     r0,#0                 ;607
00046e  e7ca              B        |L1.1030|
                  |L1.1136|
                          DCD      OSIntNesting
                  |L1.1140|
                          DCD      OSEventFreeList
                  |L1.1144|
                          DCD      OSQFreeList
                  |L1.1148|
                          DCD      OSLockNesting
                  |L1.1152|
                          DCD      OSTCBCur
                          ENDP

                  OSQPostFront PROC
;;;632    #if OS_Q_POST_FRONT_EN > 0
;;;633    INT8U  OSQPostFront (OS_EVENT *pevent, void *pmsg)
000484  e92d41f0          PUSH     {r4-r8,lr}
;;;634    {
000488  4605              MOV      r5,r0
00048a  460e              MOV      r6,r1
;;;635        OS_Q      *pq;
;;;636    #if OS_CRITICAL_METHOD == 3                           /* Allocate storage for CPU status register      */
;;;637        OS_CPU_SR  cpu_sr = 0;
00048c  2700              MOVS     r7,#0
;;;638    #endif
;;;639    
;;;640    
;;;641    
;;;642    #if OS_ARG_CHK_EN > 0
;;;643        if (pevent == (OS_EVENT *)0) {                    /* Validate 'pevent'                             */
00048e  b915              CBNZ     r5,|L1.1174|
;;;644            return (OS_ERR_PEVENT_NULL);
000490  2004              MOVS     r0,#4
                  |L1.1170|
;;;645        }
;;;646    #endif
;;;647        if (pevent->OSEventType != OS_EVENT_TYPE_Q) {     /* Validate event block type                     */
;;;648            return (OS_ERR_EVENT_TYPE);
;;;649        }
;;;650        OS_ENTER_CRITICAL();
;;;651        if (pevent->OSEventGrp != 0) {                    /* See if any task pending on queue              */
;;;652                                                          /* Ready highest priority task waiting on event  */
;;;653            (void)OS_EventTaskRdy(pevent, pmsg, OS_STAT_Q, OS_STAT_PEND_OK);
;;;654            OS_EXIT_CRITICAL();
;;;655            OS_Sched();                                   /* Find highest priority task ready to run       */
;;;656            return (OS_ERR_NONE);
;;;657        }
;;;658        pq = (OS_Q *)pevent->OSEventPtr;                  /* Point to queue control block                  */
;;;659        if (pq->OSQEntries >= pq->OSQSize) {              /* Make sure queue is not full                   */
;;;660            OS_EXIT_CRITICAL();
;;;661            return (OS_ERR_Q_FULL);
;;;662        }
;;;663        if (pq->OSQOut == pq->OSQStart) {                 /* Wrap OUT ptr if we are at the 1st queue entry */
;;;664            pq->OSQOut = pq->OSQEnd;
;;;665        }
;;;666        pq->OSQOut--;
;;;667        *pq->OSQOut = pmsg;                               /* Insert message into queue                     */
;;;668        pq->OSQEntries++;                                 /* Update the nbr of entries in the queue        */
;;;669        OS_EXIT_CRITICAL();
;;;670        return (OS_ERR_NONE);
;;;671    }
000492  e8bd81f0          POP      {r4-r8,pc}
                  |L1.1174|
000496  7828              LDRB     r0,[r5,#0]            ;647
000498  2802              CMP      r0,#2                 ;647
00049a  d001              BEQ      |L1.1184|
00049c  2001              MOVS     r0,#1                 ;648
00049e  e7f8              B        |L1.1170|
                  |L1.1184|
0004a0  f7fffffe          BL       OS_CPU_SR_Save
0004a4  4607              MOV      r7,r0                 ;650
0004a6  7aa8              LDRB     r0,[r5,#0xa]          ;651
0004a8  b160              CBZ      r0,|L1.1220|
0004aa  2300              MOVS     r3,#0                 ;653
0004ac  2204              MOVS     r2,#4                 ;653
0004ae  4631              MOV      r1,r6                 ;653
0004b0  4628              MOV      r0,r5                 ;653
0004b2  f7fffffe          BL       OS_EventTaskRdy
0004b6  4638              MOV      r0,r7                 ;654
0004b8  f7fffffe          BL       OS_CPU_SR_Restore
0004bc  f7fffffe          BL       OS_Sched
0004c0  2000              MOVS     r0,#0                 ;656
0004c2  e7e6              B        |L1.1170|
                  |L1.1220|
0004c4  686c              LDR      r4,[r5,#4]            ;658
0004c6  8ae0              LDRH     r0,[r4,#0x16]         ;659
0004c8  8aa1              LDRH     r1,[r4,#0x14]         ;659
0004ca  4288              CMP      r0,r1                 ;659
0004cc  db04              BLT      |L1.1240|
0004ce  4638              MOV      r0,r7                 ;660
0004d0  f7fffffe          BL       OS_CPU_SR_Restore
0004d4  201e              MOVS     r0,#0x1e              ;661
0004d6  e7dc              B        |L1.1170|
                  |L1.1240|
0004d8  6861              LDR      r1,[r4,#4]            ;663
0004da  6920              LDR      r0,[r4,#0x10]         ;663
0004dc  4288              CMP      r0,r1                 ;663
0004de  d101              BNE      |L1.1252|
0004e0  68a0              LDR      r0,[r4,#8]            ;664
0004e2  6120              STR      r0,[r4,#0x10]         ;664
                  |L1.1252|
0004e4  6920              LDR      r0,[r4,#0x10]         ;666
0004e6  1f00              SUBS     r0,r0,#4              ;666
0004e8  6120              STR      r0,[r4,#0x10]         ;666
0004ea  6920              LDR      r0,[r4,#0x10]         ;667
0004ec  6006              STR      r6,[r0,#0]            ;667
0004ee  8ae0              LDRH     r0,[r4,#0x16]         ;668
0004f0  1c40              ADDS     r0,r0,#1              ;668
0004f2  82e0              STRH     r0,[r4,#0x16]         ;668
0004f4  4638              MOV      r0,r7                 ;669
0004f6  f7fffffe          BL       OS_CPU_SR_Restore
0004fa  2000              MOVS     r0,#0                 ;670
0004fc  e7c9              B        |L1.1170|
;;;672    #endif
                          ENDP

                  OSQPostOpt PROC
;;;703    #if OS_Q_POST_OPT_EN > 0
;;;704    INT8U  OSQPostOpt (OS_EVENT *pevent, void *pmsg, INT8U opt)
0004fe  e92d41f0          PUSH     {r4-r8,lr}
;;;705    {
000502  4605              MOV      r5,r0
000504  460f              MOV      r7,r1
000506  4616              MOV      r6,r2
;;;706        OS_Q      *pq;
;;;707    #if OS_CRITICAL_METHOD == 3                           /* Allocate storage for CPU status register      */
;;;708        OS_CPU_SR  cpu_sr = 0;
000508  f04f0800          MOV      r8,#0
;;;709    #endif
;;;710    
;;;711    
;;;712    
;;;713    #if OS_ARG_CHK_EN > 0
;;;714        if (pevent == (OS_EVENT *)0) {                    /* Validate 'pevent'                             */
00050c  b915              CBNZ     r5,|L1.1300|
;;;715            return (OS_ERR_PEVENT_NULL);
00050e  2004              MOVS     r0,#4
                  |L1.1296|
;;;716        }
;;;717    #endif
;;;718        if (pevent->OSEventType != OS_EVENT_TYPE_Q) {     /* Validate event block type                     */
;;;719            return (OS_ERR_EVENT_TYPE);
;;;720        }
;;;721        OS_ENTER_CRITICAL();
;;;722        if (pevent->OSEventGrp != 0x00) {                 /* See if any task pending on queue              */
;;;723            if ((opt & OS_POST_OPT_BROADCAST) != 0x00) {  /* Do we need to post msg to ALL waiting tasks ? */
;;;724                while (pevent->OSEventGrp != 0) {         /* Yes, Post to ALL tasks waiting on queue       */
;;;725                    (void)OS_EventTaskRdy(pevent, pmsg, OS_STAT_Q, OS_STAT_PEND_OK);
;;;726                }
;;;727            } else {                                      /* No,  Post to HPT waiting on queue             */
;;;728                (void)OS_EventTaskRdy(pevent, pmsg, OS_STAT_Q, OS_STAT_PEND_OK);
;;;729            }
;;;730            OS_EXIT_CRITICAL();
;;;731            if ((opt & OS_POST_OPT_NO_SCHED) == 0) {	  /* See if scheduler needs to be invoked          */
;;;732                OS_Sched();                               /* Find highest priority task ready to run       */
;;;733            }
;;;734            return (OS_ERR_NONE);
;;;735        }
;;;736        pq = (OS_Q *)pevent->OSEventPtr;                  /* Point to queue control block                  */
;;;737        if (pq->OSQEntries >= pq->OSQSize) {              /* Make sure queue is not full                   */
;;;738            OS_EXIT_CRITICAL();
;;;739            return (OS_ERR_Q_FULL);
;;;740        }
;;;741        if ((opt & OS_POST_OPT_FRONT) != 0x00) {          /* Do we post to the FRONT of the queue?         */
;;;742            if (pq->OSQOut == pq->OSQStart) {             /* Yes, Post as LIFO, Wrap OUT pointer if we ... */
;;;743                pq->OSQOut = pq->OSQEnd;                  /*      ... are at the 1st queue entry           */
;;;744            }
;;;745            pq->OSQOut--;
;;;746            *pq->OSQOut = pmsg;                           /*      Insert message into queue                */
;;;747        } else {                                          /* No,  Post as FIFO                             */
;;;748            *pq->OSQIn++ = pmsg;                          /*      Insert message into queue                */
;;;749            if (pq->OSQIn == pq->OSQEnd) {                /*      Wrap IN ptr if we are at end of queue    */
;;;750                pq->OSQIn = pq->OSQStart;
;;;751            }
;;;752        }
;;;753        pq->OSQEntries++;                                 /* Update the nbr of entries in the queue        */
;;;754        OS_EXIT_CRITICAL();
;;;755        return (OS_ERR_NONE);
;;;756    }
000510  e8bd81f0          POP      {r4-r8,pc}
                  |L1.1300|
000514  7828              LDRB     r0,[r5,#0]            ;718
000516  2802              CMP      r0,#2                 ;718
000518  d001              BEQ      |L1.1310|
00051a  2001              MOVS     r0,#1                 ;719
00051c  e7f8              B        |L1.1296|
                  |L1.1310|
00051e  f7fffffe          BL       OS_CPU_SR_Save
000522  4680              MOV      r8,r0                 ;721
000524  7aa8              LDRB     r0,[r5,#0xa]          ;722
000526  b1e8              CBZ      r0,|L1.1380|
000528  f0060001          AND      r0,r6,#1              ;723
00052c  b150              CBZ      r0,|L1.1348|
00052e  e005              B        |L1.1340|
                  |L1.1328|
000530  2300              MOVS     r3,#0                 ;725
000532  2204              MOVS     r2,#4                 ;725
000534  4639              MOV      r1,r7                 ;725
000536  4628              MOV      r0,r5                 ;725
000538  f7fffffe          BL       OS_EventTaskRdy
                  |L1.1340|
00053c  7aa8              LDRB     r0,[r5,#0xa]          ;724
00053e  2800              CMP      r0,#0                 ;724
000540  d1f6              BNE      |L1.1328|
000542  e005              B        |L1.1360|
                  |L1.1348|
000544  2300              MOVS     r3,#0                 ;728
000546  2204              MOVS     r2,#4                 ;728
000548  4639              MOV      r1,r7                 ;728
00054a  4628              MOV      r0,r5                 ;728
00054c  f7fffffe          BL       OS_EventTaskRdy
                  |L1.1360|
000550  4640              MOV      r0,r8                 ;730
000552  f7fffffe          BL       OS_CPU_SR_Restore
000556  f0060004          AND      r0,r6,#4              ;731
00055a  b908              CBNZ     r0,|L1.1376|
00055c  f7fffffe          BL       OS_Sched
                  |L1.1376|
000560  2000              MOVS     r0,#0                 ;734
000562  e7d5              B        |L1.1296|
                  |L1.1380|
000564  686c              LDR      r4,[r5,#4]            ;736
000566  8ae0              LDRH     r0,[r4,#0x16]         ;737
000568  8aa1              LDRH     r1,[r4,#0x14]         ;737
00056a  4288              CMP      r0,r1                 ;737
00056c  db04              BLT      |L1.1400|
00056e  4640              MOV      r0,r8                 ;738
000570  f7fffffe          BL       OS_CPU_SR_Restore
000574  201e              MOVS     r0,#0x1e              ;739
000576  e7cb              B        |L1.1296|
                  |L1.1400|
000578  f0060002          AND      r0,r6,#2              ;741
00057c  b158              CBZ      r0,|L1.1430|
00057e  6861              LDR      r1,[r4,#4]            ;742
000580  6920              LDR      r0,[r4,#0x10]         ;742
000582  4288              CMP      r0,r1                 ;742
000584  d101              BNE      |L1.1418|
000586  68a0              LDR      r0,[r4,#8]            ;743
000588  6120              STR      r0,[r4,#0x10]         ;743
                  |L1.1418|
00058a  6920              LDR      r0,[r4,#0x10]         ;745
00058c  1f00              SUBS     r0,r0,#4              ;745
00058e  6120              STR      r0,[r4,#0x10]         ;745
000590  6920              LDR      r0,[r4,#0x10]         ;746
000592  6007              STR      r7,[r0,#0]            ;746
000594  e009              B        |L1.1450|
                  |L1.1430|
000596  68e1              LDR      r1,[r4,#0xc]          ;748
000598  1d08              ADDS     r0,r1,#4              ;748
00059a  60e0              STR      r0,[r4,#0xc]          ;748
00059c  600f              STR      r7,[r1,#0]            ;748
00059e  e9d41002          LDRD     r1,r0,[r4,#8]         ;749
0005a2  4288              CMP      r0,r1                 ;749
0005a4  d101              BNE      |L1.1450|
0005a6  6860              LDR      r0,[r4,#4]            ;750
0005a8  60e0              STR      r0,[r4,#0xc]          ;750
                  |L1.1450|
0005aa  8ae0              LDRH     r0,[r4,#0x16]         ;753
0005ac  1c40              ADDS     r0,r0,#1              ;753
0005ae  82e0              STRH     r0,[r4,#0x16]         ;753
0005b0  4640              MOV      r0,r8                 ;754
0005b2  f7fffffe          BL       OS_CPU_SR_Restore
0005b6  2000              MOVS     r0,#0                 ;755
0005b8  e7aa              B        |L1.1296|
;;;757    #endif
                          ENDP

                  OSQQuery PROC
;;;777    #if OS_Q_QUERY_EN > 0
;;;778    INT8U  OSQQuery (OS_EVENT *pevent, OS_Q_DATA *p_q_data)
0005ba  e92d47f0          PUSH     {r4-r10,lr}
;;;779    {
0005be  4605              MOV      r5,r0
0005c0  460c              MOV      r4,r1
;;;780        OS_Q      *pq;
;;;781        INT8U      i;
;;;782    #if OS_LOWEST_PRIO <= 63
;;;783        INT8U     *psrc;
;;;784        INT8U     *pdest;
;;;785    #else
;;;786        INT16U    *psrc;
;;;787        INT16U    *pdest;
;;;788    #endif
;;;789    #if OS_CRITICAL_METHOD == 3                            /* Allocate storage for CPU status register     */
;;;790        OS_CPU_SR  cpu_sr = 0;
0005c2  f04f0a00          MOV      r10,#0
;;;791    #endif
;;;792    
;;;793    
;;;794    
;;;795    #if OS_ARG_CHK_EN > 0
;;;796        if (pevent == (OS_EVENT *)0) {                     /* Validate 'pevent'                            */
0005c6  b915              CBNZ     r5,|L1.1486|
;;;797            return (OS_ERR_PEVENT_NULL);
0005c8  2004              MOVS     r0,#4
                  |L1.1482|
;;;798        }
;;;799        if (p_q_data == (OS_Q_DATA *)0) {                  /* Validate 'p_q_data'                          */
;;;800            return (OS_ERR_PDATA_NULL);
;;;801        }
;;;802    #endif
;;;803        if (pevent->OSEventType != OS_EVENT_TYPE_Q) {      /* Validate event block type                    */
;;;804            return (OS_ERR_EVENT_TYPE);
;;;805        }
;;;806        OS_ENTER_CRITICAL();
;;;807        p_q_data->OSEventGrp = pevent->OSEventGrp;         /* Copy message queue wait list                 */
;;;808        psrc                 = &pevent->OSEventTbl[0];
;;;809        pdest                = &p_q_data->OSEventTbl[0];
;;;810        for (i = 0; i < OS_EVENT_TBL_SIZE; i++) {
;;;811            *pdest++ = *psrc++;
;;;812        }
;;;813        pq = (OS_Q *)pevent->OSEventPtr;
;;;814        if (pq->OSQEntries > 0) {
;;;815            p_q_data->OSMsg = *pq->OSQOut;                 /* Get next message to return if available      */
;;;816        } else {
;;;817            p_q_data->OSMsg = (void *)0;
;;;818        }
;;;819        p_q_data->OSNMsgs = pq->OSQEntries;
;;;820        p_q_data->OSQSize = pq->OSQSize;
;;;821        OS_EXIT_CRITICAL();
;;;822        return (OS_ERR_NONE);
;;;823    }
0005ca  e8bd87f0          POP      {r4-r10,pc}
                  |L1.1486|
0005ce  b90c              CBNZ     r4,|L1.1492|
0005d0  2009              MOVS     r0,#9                 ;800
0005d2  e7fa              B        |L1.1482|
                  |L1.1492|
0005d4  7828              LDRB     r0,[r5,#0]            ;803
0005d6  2802              CMP      r0,#2                 ;803
0005d8  d001              BEQ      |L1.1502|
0005da  2001              MOVS     r0,#1                 ;804
0005dc  e7f5              B        |L1.1482|
                  |L1.1502|
0005de  f7fffffe          BL       OS_CPU_SR_Save
0005e2  4682              MOV      r10,r0                ;806
0005e4  7aa8              LDRB     r0,[r5,#0xa]          ;807
0005e6  7320              STRB     r0,[r4,#0xc]          ;807
0005e8  f105080b          ADD      r8,r5,#0xb            ;808
0005ec  f1040908          ADD      r9,r4,#8              ;809
0005f0  2700              MOVS     r7,#0                 ;810
0005f2  e005              B        |L1.1536|
                  |L1.1524|
0005f4  f8180b01          LDRB     r0,[r8],#1            ;811
0005f8  f8090b01          STRB     r0,[r9],#1            ;811
0005fc  1c78              ADDS     r0,r7,#1              ;810
0005fe  b2c7              UXTB     r7,r0                 ;810
                  |L1.1536|
000600  2f04              CMP      r7,#4                 ;810
000602  dbf7              BLT      |L1.1524|
000604  686e              LDR      r6,[r5,#4]            ;813
000606  8af0              LDRH     r0,[r6,#0x16]         ;814
000608  2800              CMP      r0,#0                 ;814
00060a  dd03              BLE      |L1.1556|
00060c  6930              LDR      r0,[r6,#0x10]         ;815
00060e  6800              LDR      r0,[r0,#0]            ;815
000610  6020              STR      r0,[r4,#0]            ;815
000612  e001              B        |L1.1560|
                  |L1.1556|
000614  2000              MOVS     r0,#0                 ;817
000616  6020              STR      r0,[r4,#0]            ;817
                  |L1.1560|
000618  8af0              LDRH     r0,[r6,#0x16]         ;819
00061a  80a0              STRH     r0,[r4,#4]            ;819
00061c  8ab0              LDRH     r0,[r6,#0x14]         ;820
00061e  80e0              STRH     r0,[r4,#6]            ;820
000620  4650              MOV      r0,r10                ;821
000622  f7fffffe          BL       OS_CPU_SR_Restore
000626  2000              MOVS     r0,#0                 ;822
000628  e7cf              B        |L1.1482|
;;;824    #endif                                                 /* OS_Q_QUERY_EN                                */
                          ENDP

                  OS_QInit PROC
;;;841    
;;;842    void  OS_QInit (void)
00062a  b570              PUSH     {r4-r6,lr}
;;;843    {
;;;844    #if OS_MAX_QS == 1
;;;845        OSQFreeList         = &OSQTbl[0];                /* Only ONE queue!                                */
;;;846        OSQFreeList->OSQPtr = (OS_Q *)0;
;;;847    #endif
;;;848    
;;;849    #if OS_MAX_QS >= 2
;;;850        INT16U  i;
;;;851        OS_Q   *pq1;
;;;852        OS_Q   *pq2;
;;;853    
;;;854    
;;;855    
;;;856        OS_MemClr((INT8U *)&OSQTbl[0], sizeof(OSQTbl));  /* Clear the queue table                          */
00062c  21f0              MOVS     r1,#0xf0
00062e  480a              LDR      r0,|L1.1624|
000630  f7fffffe          BL       OS_MemClr
;;;857        pq1 = &OSQTbl[0];
000634  4c08              LDR      r4,|L1.1624|
;;;858        pq2 = &OSQTbl[1];
000636  f1040618          ADD      r6,r4,#0x18
;;;859        for (i = 0; i < (OS_MAX_QS - 1); i++) {          /* Init. list of free QUEUE control blocks        */
00063a  2500              MOVS     r5,#0
00063c  e004              B        |L1.1608|
                  |L1.1598|
;;;860            pq1->OSQPtr = pq2;
00063e  6026              STR      r6,[r4,#0]
;;;861            pq1++;
000640  3418              ADDS     r4,r4,#0x18
;;;862            pq2++;
000642  3618              ADDS     r6,r6,#0x18
000644  1c68              ADDS     r0,r5,#1              ;859
000646  b285              UXTH     r5,r0                 ;859
                  |L1.1608|
000648  2d09              CMP      r5,#9                 ;859
00064a  dbf8              BLT      |L1.1598|
;;;863        }
;;;864        pq1->OSQPtr = (OS_Q *)0;
00064c  2000              MOVS     r0,#0
00064e  6020              STR      r0,[r4,#0]
;;;865        OSQFreeList = &OSQTbl[0];
000650  4801              LDR      r0,|L1.1624|
000652  4902              LDR      r1,|L1.1628|
000654  6008              STR      r0,[r1,#0]  ; OSQFreeList
;;;866    #endif
;;;867    }
000656  bd70              POP      {r4-r6,pc}
;;;868    #endif                                               /* OS_Q_EN                                        */
                          ENDP

                  |L1.1624|
                          DCD      OSQTbl
                  |L1.1628|
                          DCD      OSQFreeList
